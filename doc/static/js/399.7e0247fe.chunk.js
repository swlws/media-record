"use strict";(self.webpackChunkmedia_record=self.webpackChunkmedia_record||[]).push([[399],{399:function(e,n,t){t.r(n),t.d(n,{default:function(){return f}});var r=t(335),c=t(97),i="video_container__4aev9",u="video_block-layout__nMBGt",o=t(263);function s(e){var n,t,i=(0,c.useState)([]),u=(0,r.Z)(i,2),o=u[0],s=u[1];return[o,function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(r){n=r,t=new MediaRecorder(r);var c=e.current;return c.srcObject=r,new Promise((function(e){return c.onplaying=e}))})).then((function(){return e=t,new Promise((function(n,t){var r=[];e.onstart=function(e){r=[]},e.ondataavailable=function(e){r.push(e.data)},e.onstop=function(e){n(r)},e.start()}));var e})).then((function(e){console.log(e),s(e)}))},function(){n&&n.getTracks().forEach((function(e){return e.stop()})),t&&t.stop()}]}function a(){var e=(0,c.useRef)(null);return(0,c.useEffect)((function(){var n=e.current;n.onloadedmetadata=n.play}),[]),[e]}function d(e){var n=a(),t=(0,r.Z)(n,1)[0],i=s(t),d=(0,r.Z)(i,3),l=d[0],f=d[1],h=d[2];return(0,c.useEffect)((function(){0!==l.length&&e.upload(l)}),[l,e]),(0,o.jsxs)("article",{className:u,children:[(0,o.jsx)("header",{children:"\u5f55\u5236\u89c6\u9891"}),(0,o.jsx)("main",{children:(0,o.jsx)("video",{ref:t,src:"",muted:!0})}),(0,o.jsxs)("footer",{children:[(0,o.jsx)("button",{onClick:f,children:"\u5f00\u59cb\u5f55\u5236"}),(0,o.jsx)("button",{onClick:h,children:"\u505c\u6b62\u5f55\u5236"})]})]})}function l(e){var n=a(),t=(0,r.Z)(n,1)[0],i=(0,c.useState)(!1),s=(0,r.Z)(i,2),d=s[0],l=s[1],f=(0,c.useState)(""),h=(0,r.Z)(f,2),v=h[0],j=h[1],x=(0,c.useState)({size:0,type:""}),m=(0,r.Z)(x,2),p=m[0],b=m[1];(0,c.useEffect)((function(){var n=0!==e.chunks.length;if(l(n),!1!==n){var t=new Blob(e.chunks,{type:"video/webm"});j(URL.createObjectURL(t)),b({size:t.size,type:t.type})}}),[e]);return(0,o.jsxs)("article",{className:u,children:[(0,o.jsx)("header",{children:"\u64ad\u653e\u89c6\u9891"}),(0,o.jsx)("main",{children:(0,o.jsx)("video",{ref:t,src:v,controls:d})}),d?(0,o.jsxs)("footer",{children:[(0,o.jsx)("button",{onClick:function(){return e=t,void(document.pictureInPictureElement?document.exitPictureInPicture():document.pictureInPictureEnabled&&e.current.requestPictureInPicture());var e},children:"\u753b\u4e2d\u753b"}),(0,o.jsx)("button",{children:(0,o.jsx)("a",{href:v,download:"video.webm",children:"\u4e0b\u8f7d"})}),(0,o.jsxs)("p",{children:["the video file ",p.size," bytes of ",p.type," media"]})]}):null]})}function f(){var e=(0,c.useState)([]),n=(0,r.Z)(e,2),t=n[0],u=n[1];return(0,o.jsxs)("article",{className:i,children:[(0,o.jsx)(d,{upload:function(e){u(e)}}),(0,o.jsx)(l,{chunks:t})]})}}}]);
//# sourceMappingURL=399.7e0247fe.chunk.js.map