{"version":3,"file":"static/js/428.f9a7d512.chunk.js","mappings":"iKAaIA,E,iBCZJ,EAA4B,0B,SDuCb,SAASC,IACtB,MAtCF,WACE,IAAMC,GAAWC,EAAAA,EAAAA,QAAO,MAMxB,OALAC,EAAAA,EAAAA,YAAU,WACR,IAAMC,EAAQH,EAASI,QACvBD,EAAME,iBAAmBF,EAAMG,IAChC,GAAE,IAEI,CAACN,EACT,CA8BoBO,GAAZP,GAAP,eACA,EA5BF,SAAoBA,GAClB,IAeMQ,EAAO,WACNV,IAELA,EAAYW,YAAYC,SAAQ,SAACC,GAAD,OAAWA,EAAMH,MAAjB,IAChCV,EAAc,KACf,EAED,MAAO,CAtBQ,WACbU,IAEAI,UAAUC,aACPC,gBAAgB,CACfC,OAAO,EACPZ,OAAO,IAERa,MAAK,SAACC,GACLnB,EAAcmB,EACAjB,EAASI,QACjBc,UAAYD,CACnB,GACJ,EASeT,EACjB,CAIwBW,CAAWnB,GAAlC,eAAOoB,EAAP,KAAeZ,EAAf,KAEA,OACE,qBAASa,UAAWC,EAApB,WACE,0DAEA,kBAAOC,IAAKvB,KAEZ,+BACE,mBAAQwB,QAASJ,EAAjB,mDACA,mBAAQI,QAAShB,EAAjB,2CAIP,C","sources":["views/screen/index.tsx","webpack://media-record/./src/views/screen/index.module.scss?2a92"],"sourcesContent":["import { useEffect, useRef } from \"react\";\nimport styles from \"./index.module.scss\";\n\nfunction useAutoplay() {\n  const videoRef = useRef(null);\n  useEffect(() => {\n    const video = videoRef.current as any;\n    video.onloadedmetadata = video.play;\n  }, []);\n\n  return [videoRef];\n}\n\nlet cacheStream: MediaStream | null;\nfunction useCapture(videoRef: React.MutableRefObject<any>) {\n  const change = () => {\n    stop();\n\n    navigator.mediaDevices\n      .getDisplayMedia({\n        audio: true,\n        video: true,\n      })\n      .then((stream) => {\n        cacheStream = stream;\n        const video = videoRef.current as any;\n        video.srcObject = stream;\n      });\n  };\n\n  const stop = () => {\n    if (!cacheStream) return;\n\n    cacheStream.getTracks().forEach((track) => track.stop());\n    cacheStream = null;\n  };\n\n  return [change, stop];\n}\n\nexport default function Screen() {\n  const [videoRef] = useAutoplay();\n  const [change, stop] = useCapture(videoRef);\n\n  return (\n    <article className={styles.container}>\n      <header>共享屏幕</header>\n\n      <video ref={videoRef}></video>\n\n      <footer>\n        <button onClick={change}>选择共享窗口</button>\n        <button onClick={stop}>停止共享</button>\n      </footer>\n    </article>\n  );\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"screen_container__juPVo\"};"],"names":["cacheStream","Screen","videoRef","useRef","useEffect","video","current","onloadedmetadata","play","useAutoplay","stop","getTracks","forEach","track","navigator","mediaDevices","getDisplayMedia","audio","then","stream","srcObject","useCapture","change","className","styles","ref","onClick"],"sourceRoot":""}